{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Уведомления" %} - EventHub{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Заголовок -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h2 fw-bold text-primary">{% trans "Уведомления" %}</h1>
        <a href="{% url 'event_list' %}" class="btn btn-outline-secondary btn-sm">
          <i class="fas fa-arrow-left me-1"></i> {% trans "Назад к мероприятиям" %}
        </a>
      </div>

      <!-- Список уведомлений -->
      {% if notifications %}
        <div class="list-group">
          {% for notification in notifications %}
            <a href="{% if notification.event %}{% url 'event_detail' notification.event.pk %}{% else %}#{% endif %}"
               class="list-group-item list-group-item-action d-flex gap-3 p-3 {% if not notification.is_read %}bg-light{% endif %}">
              <div class="flex-shrink-0">
                <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center"
                     style="width: 40px; height: 40px;">
                  <i class="fas fa-bell"></i>
                </div>
              </div>
              <div class="flex-grow-1">
                <div class="d-flex justify-content-between">
                  <h6 class="mb-1 fw-semibold">{{ notification.message|truncatechars:80 }}</h6>
                  <small class="text-muted">{{ notification.sent_at|timesince }} {% trans "назад" %}</small>
                </div>
                {% if notification.event %}
                  <p class="mb-1 text-muted small">{{ notification.event.title }}</p>
                  <span class="badge bg-secondary">{{ notification.event.get_event_type_display }}</span>
                {% endif %}
              </div>
            </a>
          {% endfor %}
        </div>

        <!-- Кнопка "Отметить всё как прочитанное" (опционально) -->
        <!--
        <div class="mt-4 text-center">
          <form method="post" action="{% url 'mark_all_notifications_read' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-primary">
              <i class="fas fa-check-double me-1"></i> {% trans "Отметить всё как прочитанное" %}
            </button>
          </form>
        </div>
        -->

      {% else %}
        <div class="text-center py-5">
          <div class="mb-3">
            <i class="fas fa-bell-slash fa-3x text-muted"></i>
          </div>
          <h4 class="text-muted">{% trans "У вас пока нет уведомлений" %}</h4>
          <p class="text-muted mt-2">{% trans "Здесь будут появляться оповещения о новых мероприятиях, регистрации и других событиях." %}</p>
          <a href="{% url 'event_list' %}" class="btn btn-primary mt-3">
            <i class="fas fa-calendar-alt me-1"></i> {% trans "Посмотреть мероприятия" %}
          </a>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}